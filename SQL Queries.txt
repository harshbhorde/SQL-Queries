-- 1. DISPLAY ALL THE EMPLOYEES WHOSE DEPARTMENT NAME ENDS WITH 'S'
SELECT * FROM emp
WHERE deptno IN (SELECT deptno FROM dept WHERE dname LIKE '%S');

-- 2. QUERY TO DISPLAY THE EMPLOYEE NAMES WHO IS HAVING MAXIMUM SALARY IN DEPT NAME "ACCOUNTING"
SELECT ename FROM emp
WHERE sal = (SELECT MAX(sal) FROM emp WHERE deptno = (SELECT deptno FROM dept WHERE dname = 'ACCOUNTING'));

-- 3. QUERY TO DISPLAY THE DEPT NAME WHO IS HAVING HIGHEST COMMISSION
SELECT dname FROM dept
WHERE deptno = (SELECT deptno FROM emp WHERE comm = (SELECT MAX(comm) FROM emp));

-- 4. QUERY TO DISPLAY THE EMPLOYEE NAMES WHOSE DEPARTMENT NAME HAS 2ND CHARACTER AS 'O'
SELECT ename FROM emp
WHERE deptno IN (SELECT deptno FROM dept WHERE dname LIKE '_O%');

-- 5. QUERY TO DISPLAY ALL THE EMPLOYEES WHOSE DEPT NUMBER IS SAME AS SCOTT
SELECT * FROM emp
WHERE deptno = (SELECT deptno FROM emp WHERE ename = 'SCOTT');

-- 6. QUERY TO DISPLAY ALL THE EMPLOYEES IN 'OPERATIONS AND ACCOUNTING' DEPT.
SELECT * FROM emp
WHERE deptno IN (SELECT deptno FROM dept WHERE dname IN ('OPERATIONS', 'ACCOUNTING'));

-- 7. LIST THE EMPLOYEES WHO HAS SALARY GREATER THAN MILLER
SELECT * FROM emp
WHERE sal > (SELECT sal FROM emp WHERE ename = 'MILLER');

-- 8. LIST DEPARTMENT NAME HAVING AT LEAST 3 SALESMAN
SELECT dname FROM dept
WHERE deptno IN (SELECT deptno FROM emp WHERE job = 'SALESMAN' GROUP BY deptno HAVING COUNT(*) >= 3);

-- 9. DISPLAY THE DNAME OF AN EMPLOYEE WHO HAS NO REPORTING MANAGER
SELECT dname FROM dept
WHERE deptno IN (SELECT deptno FROM emp WHERE mgr IS NULL);

-- 10. LIST ALL THE EMPLOYEES WHO ARE REPORTING TO JONES MANAGER
SELECT * FROM emp
WHERE mgr = (SELECT empno FROM emp WHERE ename = 'JONES');

-- 11. LIST EMPLOYEES FROM RESEARCH & ACCOUNTING HAVING AT LEAST 2 REPORTING.
SELECT * FROM emp
WHERE deptno IN (SELECT deptno FROM dept WHERE dname IN ('RESEARCH', 'ACCOUNTING'))
AND empno IN (SELECT mgr FROM emp GROUP BY mgr HAVING COUNT(*) >= 2);

-- 12. DISPLAY THE DEPTNAME OF THE EMPLOYEE WHOSE NAME DOES NOT START WITH S AND SALARY BETWEEN 1500 TO 3000
SELECT dname FROM dept
WHERE deptno IN (SELECT deptno FROM emp WHERE ename NOT LIKE 'S%' AND sal BETWEEN 1500 AND 3000);

-- 13. DISPLAY LOCATION OF EMPLOYEE WHOSE SALARY IS MINIMUM SALARY BUT SALARY IS GREATER THAN 2000
SELECT loc FROM dept
WHERE deptno = (SELECT deptno FROM emp WHERE sal = (SELECT MIN(sal) FROM emp WHERE sal > 2000));

-- 14. DISPLAY THE LOCATION OF AN EMPLOYEE IN ACCOUNTING DEPARTMENT
SELECT loc FROM dept WHERE deptno = (SELECT deptno FROM dept WHERE dname = 'ACCOUNTING');

-- 15. DISPLAY THE DEPARTMENT'S LOCATION THAT IS HAVING GREATER THAN FOUR EMPLOYEES IN IT
SELECT loc FROM dept
WHERE deptno IN (SELECT deptno FROM emp GROUP BY deptno HAVING COUNT(*) > 4);

-- 16. WRITE A QUERY TO DISPLAY ALL THE EMPLOYEE WHOSE JOB NOT SAME AS ALLEN AND SALARY IS GREATER THAN MARTIN
SELECT * FROM emp
WHERE job <> (SELECT job FROM emp WHERE ename = 'ALLEN')
AND sal > (SELECT sal FROM emp WHERE ename = 'MARTIN');

-- 17. DISPLAY ALL THE EMPLOYEES WHO IS HAVING LOCATION IS SAME AS ADAM'S MANAGER?
SELECT * FROM emp
WHERE deptno = (SELECT deptno FROM dept WHERE loc = 
(SELECT loc FROM dept WHERE deptno = (SELECT deptno FROM emp WHERE empno = 
(SELECT mgr FROM emp WHERE ename = 'ADAMS'))));

-- 18. DISPLAY THE JOB, MANAGER NUMBER OF EMPLOYEES WHO IS WORKING FOR JONES?
SELECT job, mgr FROM emp WHERE mgr = (SELECT empno FROM emp WHERE ename = 'JONES');

-- 19. DISPLAY THE EMPLOYEE NAMES, HIRE DATE, COMMISSION OF FORD'S MANAGER?
SELECT ename, hiredate, comm FROM emp
WHERE empno = (SELECT mgr FROM emp WHERE ename = 'FORD');

-- 20. DISPLAY THE NUMBER OF EMPLOYEES WHO ARE GETTING SALARY LESS THAN THE BLAKE'S MANAGER
SELECT COUNT(*) FROM emp WHERE sal < 
(SELECT sal FROM emp WHERE empno = (SELECT mgr FROM emp WHERE ename = 'BLAKE'));

-- 21. LIST EMPLOYEES WHO LOCATED IN CHICAGO AND THEIR COMMISSION IS ZERO.
SELECT * FROM emp WHERE comm = 0
AND deptno = (SELECT deptno FROM dept WHERE loc = 'CHICAGO');

-- 22. LIST EMPLOYEES WHO WORK FOR SALES DEPARTMENT AND THEIR SALARY GREATER THAN AVERAGE SALARY OF THEIR DEPARTMENT.
SELECT * FROM emp WHERE deptno = (SELECT deptno FROM dept WHERE dname = 'SALES')
AND sal > (SELECT AVG(sal) FROM emp WHERE deptno = (SELECT deptno FROM dept WHERE dname = 'SALES'));

-- 23. LIST EMPLOYEES WHO ARE WORKING IN RESEARCH DEPARTMENT AND THEY ARE MANAGER.
SELECT * FROM emp WHERE job = 'MANAGER'
AND deptno = (SELECT deptno FROM dept WHERE dname = 'RESEARCH');

-- 24. DISPLAY DEPARTMENT NAME OF THE EMPLOYEES WHO EARN COMMISSION.
SELECT dname FROM dept
WHERE deptno IN (SELECT deptno FROM emp WHERE comm IS NOT NULL);

-- 25. DISPLAY DEPARTMENT NAME OF THE EMPLOYEE WHO EARN MAXIMUM SALARY AND HAVE NO REPORTING MANAGER.
SELECT dname FROM dept WHERE deptno =
(SELECT deptno FROM emp WHERE sal = (SELECT MAX(sal) FROM emp WHERE mgr IS NULL));

-- 26. DISPLAY EMPLOYEE DETAILS WHO ARE REPORTING TO BLAKE AND HAVE COMMISSION WITHOUT USING NULL OR NOT NULL
SELECT * FROM emp WHERE mgr = (SELECT empno FROM emp WHERE ename = 'BLAKE') 
AND comm >= 0;

-- 27. LIST OUT THE NUMBER AND LOCATION OF ALL THE SALESMAN MANAGER-MANAGER'S
SELECT deptno, loc FROM dept WHERE deptno IN
(SELECT deptno FROM emp WHERE empno IN 
(SELECT mgr FROM emp WHERE job = 'SALESMAN'));

-- 28. LIST THE EMPLOYEE DEPTNAME AND LOC OF ALL THE EMPLOYEES WHO ARE CLERK, REPORTING TO BLAKE AND SALARY IS LESSER THAN MARTIN'S SALARY
SELECT dname, loc FROM dept 
WHERE deptno IN (SELECT deptno FROM emp WHERE job = 'CLERK' 
AND mgr = (SELECT empno FROM emp WHERE ename = 'BLAKE') 
AND sal < (SELECT sal FROM emp WHERE ename = 'MARTIN'));

-- 29. LIST THE EMPLOYEES WHO DO NOT DIRECTLY REPORT TO PRESIDENT, HAVE COMMISSION AND SALARY MORE THAN MAX SALARY OF ALL THE CLERK WITHOUT USING NULL OR NOT NULL
SELECT * FROM emp 
WHERE mgr <> (SELECT empno FROM emp WHERE job = 'PRESIDENT') 
AND comm >= 0 
AND sal > (SELECT MAX(sal) FROM emp WHERE job = 'CLERK');

-- 30. LIST THE EMPLOYEES WHO JOINED AFTER 2 YEARS OF FIRST EMPLOYEE OF THE COMPANY AND MORE THAN BLAKE'S SALARY
SELECT * FROM emp 
WHERE hiredate > (SELECT MIN(hiredate) + INTERVAL '2' YEAR FROM emp) 
AND sal > (SELECT sal FROM emp WHERE ename = 'BLAKE');

-- 31. DISPLAY LOCATION OF ALL THE EMPLOYEES WHO REPORT TO BLAKE
SELECT loc FROM dept 
WHERE deptno IN (SELECT deptno FROM emp WHERE mgr = (SELECT empno FROM emp WHERE ename = 'BLAKE'));

-- 32. LIST ALL THE EMPLOYEES WHOSE JOB IS SAME AS JONES AND THEIR SALARY LESS THAN SCOTT
SELECT * FROM emp 
WHERE job = (SELECT job FROM emp WHERE ename = 'JONES') 
AND sal < (SELECT sal FROM emp WHERE ename = 'SCOTT');

-- 33. DISPLAY ALL THE EMPLOYEES OF DEPARTMENT 30, 20 WITH THEIR ANNUAL SALARY AND HAVING AT LEAST 3 EMPLOYEES
SELECT *, sal*12 AS annual_salary FROM emp 
WHERE deptno IN (30, 20) 
AND deptno IN (SELECT deptno FROM emp GROUP BY deptno HAVING COUNT(*) >= 3);

-- 34. DISPLAY ALL THE EMPLOYEES WHO EARN LESS THAN ANY SALESMAN
SELECT * FROM emp 
WHERE sal < (SELECT MIN(sal) FROM emp WHERE job = 'SALESMAN');

-- 35. DISPLAY ALL THE EMPLOYEES WHO JOINED BEFORE THE LAST PERSON
SELECT * FROM emp 
WHERE hiredate < (SELECT MAX(hiredate) FROM emp);

-- 36. FIND 3RD MINIMUM SALARY IN THE EMPLOYEE TABLE
SELECT sal FROM emp ORDER BY sal LIMIT 1 OFFSET 2;

-- 37. DISPLAY ALL THE EMPLOYEES WHO EARN MORE THAN ANY MANAGER
SELECT * FROM emp 
WHERE sal > (SELECT MAX(sal) FROM emp WHERE job = 'MANAGER');

-- 38. LIST EMPLOYEES WHO JOINED AFTER 4 YEARS OF 1ST EMPLOYEE OF THE COMPANY AND LESS THAN BLAKE'S SALARY
SELECT * FROM emp 
WHERE hiredate > (SELECT MIN(hiredate) + INTERVAL '4' YEAR FROM emp) 
AND sal < (SELECT sal FROM emp WHERE ename = 'BLAKE');

-- 39. DISPLAY THE DEPARTMENT INFORMATION OF EMPLOYEE WHO IS WORKING FOR NEW YORK LOCATION
SELECT * FROM dept WHERE loc = 'NEW YORK';

-- 40. DISPLAY LOCATION OF EMPLOYEES WHOSE NAME DOESN'T START WITH 'A' AND SALARY BETWEEN 1000 AND 3000
SELECT loc FROM dept WHERE deptno IN 
(SELECT deptno FROM emp WHERE ename NOT LIKE 'A%' AND sal BETWEEN 1000 AND 3000);

-- 41. DISPLAY DEPARTMENT NAME OF ALL THE EMPLOYEES WHO REPORT TO BLAKE
SELECT dname FROM dept WHERE deptno IN 
(SELECT deptno FROM emp WHERE mgr = (SELECT empno FROM emp WHERE ename = 'BLAKE'));

-- 42. DISPLAY MARTIN'S MANAGER'S MANAGER'S DEPARTMENT NAME AND LOCATION
SELECT dname, loc FROM dept WHERE deptno = 
(SELECT deptno FROM emp WHERE empno = 
(SELECT mgr FROM emp WHERE empno = 
(SELECT mgr FROM emp WHERE ename = 'MARTIN')));

-- 43. DISPLAY THE MANAGER NUMBER, JOB, AND DEPARTMENT NUMBER FOR THOSE WHO DON'T HAVE COMMISSION IN CHICAGO OR DALLAS
SELECT mgr, job, deptno FROM emp 
WHERE comm IS NULL 
AND deptno IN (SELECT deptno FROM dept WHERE loc IN ('CHICAGO', 'DALLAS'));

-- 44. DISPLAY THE EMPLOYEE DETAILS WITH THEIR ANNUAL SALARY WHO EARN MAXIMUM COMMISSION
SELECT *, sal*12 AS annual_salary FROM emp 
WHERE comm = (SELECT MAX(comm) FROM emp);

-- 45. DISPLAY ALL THE EMPLOYEES WHOSE DEPARTMENT IS SALES AND WHO IS EARNING SOME COMMISSION AND IS HIRED BEFORE THE LAST PERSON HIRED
SELECT * FROM emp 
WHERE deptno = (SELECT deptno FROM dept WHERE dname = 'SALES') 
AND comm > 0 
AND hiredate < (SELECT MAX(hiredate) FROM emp);

-- 46. DISPLAY ALL THE DEPARTMENT NAMES FOR WARD'S MANAGER'S MANAGER
SELECT dname FROM dept WHERE deptno = 
(SELECT deptno FROM emp WHERE empno = 
(SELECT mgr FROM emp WHERE empno = 
(SELECT mgr FROM emp WHERE ename = 'WARD')));

-- 47. DISPLAY DEPARTMENT NAMES OF EMPLOYEES WHOSE SALARY IS GREATER THAN AVERAGE SALARY OF ALL THE CLERKS
SELECT dname FROM dept WHERE deptno IN 
(SELECT deptno FROM emp WHERE sal > 
(SELECT AVG(sal) FROM emp WHERE job = 'CLERK'));

-- 48. DISPLAY THE LAST EMPLOYEE RECORD WITH A 25% HIKE IN SALARY
SELECT *, sal * 1.25 AS hiked_salary FROM emp 
WHERE hiredate = (SELECT MAX(hiredate) FROM emp);

-- 49. DISPLAY THE DEPARTMENT NUMBER WHO WORK IN SALES DEPARTMENT AND ARE MANAGERS
SELECT deptno FROM emp WHERE job = 'MANAGER' 
AND deptno = (SELECT deptno FROM dept WHERE dname = 'SALES');

-- 49. DISPLAY DEPARTMENT NAME OF THE EMPLOYEE WHO EARN MINIMUM SALARY AND HAVE REPORTING MANAGER.
SELECT dname FROM dept WHERE deptno = 
(SELECT deptno FROM emp WHERE sal = (SELECT MIN(sal) FROM emp WHERE mgr IS NOT NULL));

-- 50. DISPLAY HIREDATE AND JOB OF ALL THE EMPLOYEES WORKING FOR SALES.
SELECT hiredate, job FROM emp 
WHERE deptno = (SELECT deptno FROM dept WHERE dname = 'SALES');

-- 51. DISPLAY LOCATION AND DNAME OF EMPLOYEE WHO WORKS AS PRESIDENT.
SELECT loc, dname FROM dept WHERE deptno = 
(SELECT deptno FROM emp WHERE job = 'PRESIDENT');

-- 52. DISPLAY THE DNAME OF EMPLOYEES WHOSE SALARY IS MAXIMUM SALARY BUT LESSER THAN 3000.
SELECT dname FROM dept WHERE deptno = 
(SELECT deptno FROM emp WHERE sal = (SELECT MAX(sal) FROM emp WHERE sal < 3000));

-- 53. DISPLAY THE DEPARTMENT NAME WHO ARE REPORTING TO ADAMS.
SELECT dname FROM dept WHERE deptno IN 
(SELECT deptno FROM emp WHERE mgr = (SELECT empno FROM emp WHERE ename = 'ADAMS'));

-- 54. DISPLAY LAST EMPLOYEE RECORD ACCORDING TO EMPNO.
SELECT * FROM emp WHERE empno = (SELECT MAX(empno) FROM emp);

-- 55. DISPLAY ALL THE EMPLOYEES WHOSE SALARY IS GREATER THAN AVERAGE SALARY OF DEPARTMENT 30.
SELECT * FROM emp WHERE sal > 
(SELECT AVG(sal) FROM emp WHERE deptno = 30);

-- 56. DISPLAY THE NUMBER OF EMPLOYEES WHO WORK FOR RESEARCH DEPT AND THEIR SALARY IS LESSER THAN ONE OF THE SALARY IN DEPARTMENT 10.
SELECT COUNT(*) FROM emp WHERE deptno = 
(SELECT deptno FROM dept WHERE dname = 'RESEARCH') 
AND sal < (SELECT MAX(sal) FROM emp WHERE deptno = 10);

-- 57. DISPLAY THE DNAME THAT ARE HAVING CLERK IN IT.
SELECT dname FROM dept WHERE deptno IN 
(SELECT deptno FROM emp WHERE job = 'CLERK');

-- 58. DISPLAY THE DEPARTMENT NAMES THAT ARE HAVING AT LEAST ONE L IN IT.
SELECT dname FROM dept WHERE dname LIKE '%L%';

-- 59. DISPLAY ALL THE EMPLOYEES WHO ARE JOINED AFTER BLAKE.
SELECT * FROM emp WHERE hiredate > 
(SELECT hiredate FROM emp WHERE ename = 'BLAKE');

-- 60. LIST THE DEPT NAME THAT ARE HAVING AT LEAST 3 EMPLOYEES BUT NOT MORE THAN 5 EMPLOYEES IN IT.
SELECT dname FROM dept WHERE deptno IN 
(SELECT deptno FROM emp GROUP BY deptno HAVING COUNT(*) BETWEEN 3 AND 5);

-- 61. DISPLAY THE LOCATION OF ALL EMPLOYEES WHOSE REPORTING MANAGER SALARY IS GREATER THAN 2000.
SELECT loc FROM dept WHERE deptno IN 
(SELECT deptno FROM emp WHERE mgr IN 
(SELECT empno FROM emp WHERE sal > 2000));

-- 62. SELECT THE EMPLOYEES WHOSE DNAME IS HAVING AT LEAST TWO 'E' IN IT.
SELECT * FROM emp WHERE deptno IN 
(SELECT deptno FROM dept WHERE dname LIKE '%E%E%');

-- 63. DISPLAY ENAME, SAL OF EMPLOYEES WHO ARE EARNING MORE THAN ANY OF THE ANALYST.
SELECT ename, sal FROM emp WHERE sal > 
(SELECT MIN(sal) FROM emp WHERE job = 'ANALYST');

-- 64. SELECT ALL THE EMPLOYEES WHO ARE WORKING FOR CHICAGO.
SELECT * FROM emp WHERE deptno = 
(SELECT deptno FROM dept WHERE loc = 'CHICAGO');

-- 65. QUERY TO DISPLAY EMPLOYEE NAMES WHO IS HAVING MINIMUM SALARY IN DEPARTMENT RESEARCH.
SELECT ename FROM emp WHERE sal = 
(SELECT MIN(sal) FROM emp WHERE deptno = 
(SELECT deptno FROM dept WHERE dname = 'RESEARCH'));

-- 66. LIST THE DEPARTMENT NAMES THAT ARE HAVING SALESMAN.
SELECT dname FROM dept WHERE deptno IN 
(SELECT deptno FROM emp WHERE job = 'SALESMAN');

-- 67. LIST THE DEPARTMENT NAMES THAT ARE HAVING AT LEAST 3 EMPLOYEES IN IT.
SELECT dname FROM dept WHERE deptno IN 
(SELECT deptno FROM emp GROUP BY deptno HAVING COUNT(*) >= 3);

-- 68. LIST EMPLOYEES FROM RESEARCH AND ACCOUNTING DEPARTMENT HAVING AT LEAST TWO REPORTING.
SELECT * FROM emp WHERE deptno IN 
(SELECT deptno FROM dept WHERE dname IN ('RESEARCH', 'ACCOUNTING')) 
AND empno IN (SELECT mgr FROM emp GROUP BY mgr HAVING COUNT(*) >= 2);

-- 69. WRITE A QUERY TO DISPLAY EMPLOYEE NAME, JOB, LOCATION OF ALL EMPLOYEES WHO ARE WORKING AS MANAGER AND WORKS AT CHICAGO.
SELECT ename, job, loc FROM emp, dept WHERE job = 'MANAGER' 
AND deptno = (SELECT deptno FROM dept WHERE loc = 'CHICAGO');

-- 70. SELECT ENAME OF EMPLOYEE WHO EARNS 2ND MAX SALARY AND WORKS FOR LOCATION DALLAS.
SELECT ename FROM emp WHERE sal = 
(SELECT DISTINCT sal FROM emp ORDER BY sal DESC LIMIT 1 OFFSET 1) 
AND deptno = (SELECT deptno FROM dept WHERE loc = 'DALLAS');

-- 71. WRITE A QUERY TO DISPLAY THE EMPLOYEE INFORMATION WHO IS NOT TAKING COMMISSION AND JOINED COMPANY AFTER JULY 83.
SELECT * FROM emp WHERE comm IS NULL 
AND hiredate > '1983-07-01';

-- 72. LIST EMPLOYEES FROM SALES AND RESEARCH DEPARTMENT HAVING AT LEAST 2 REPORTING EMPLOYEES.
SELECT * FROM emp WHERE deptno IN 
(SELECT deptno FROM dept WHERE dname IN ('SALES', 'RESEARCH')) 
AND empno IN (SELECT mgr FROM emp GROUP BY mgr HAVING COUNT(*) >= 2);

-- 73. LIST EMPLOYEES WHO HAVE COMMISSION GREATER THAN MAXIMUM SALARY OF ALL THE SALESMAN AND WHO DO NOT REPORT TO KING DIRECTLY.
SELECT * FROM emp WHERE comm > 
(SELECT MAX(sal) FROM emp WHERE job = 'SALESMAN') 
AND mgr <> (SELECT empno FROM emp WHERE ename = 'KING');

-- 74. DISPLAY THE LOCATION OF ALL THE DEPARTMENTS WHICH HAVE EMPLOYEES JOINED IN THE YEAR 81
SELECT LOC FROM DEPT WHERE DEPTNO IN 
(SELECT DISTINCT DEPTNO FROM EMP WHERE TO_CHAR(HIREDATE, 'YY') = '81');

-- 75. DISPLAY DEPARTMENT WISE MINIMUM SALARY WHICH IS LESS THAN AVERAGE SALARY OF EMPLOYEES.
SELECT DEPTNO, MIN(SAL) AS MIN_SAL FROM EMP GROUP BY DEPTNO 
HAVING MIN(SAL) < (SELECT AVG(SAL) FROM EMP);

-- 76. DISPLAY ALL THE EMPLOYEES WHO ARE REPORTING TO 'JONES'.
SELECT * FROM EMP WHERE MGR = (SELECT EMPNO FROM EMP WHERE ENAME = 'JONES');

-- 77. DISPLAY ALL THE EMPLOYEE INFORMATION WHO ARE LIVING IN A LOCATION WHICH IS HAVING AT LEAST 2 'O' IN IT.
SELECT * FROM EMP WHERE DEPTNO IN 
(SELECT DEPTNO FROM DEPT WHERE LOC LIKE '%O%O%');

-- 78. DISPLAY THE NAMES OF EMPLOYEE FROM DEPARTMENT NUMBER 10 WITH SALARY GREATER THAN THAT OF ALL EMPLOYEES WORKING IN OTHER DEPARTMENTS.
SELECT ENAME FROM EMP WHERE DEPTNO = 10 AND SAL > 
(SELECT MAX(SAL) FROM EMP WHERE DEPTNO <> 10);

-- 79. DISPLAY THE NAMES OF EMPLOYEES WHO EARN HIGHEST SALARY IN THEIR RESPECTIVE JOBS.
SELECT ENAME FROM EMP WHERE (JOB, SAL) IN 
(SELECT JOB, MAX(SAL) FROM EMP GROUP BY JOB);

-- 80. DISPLAY THE EMPLOYEE NUMBER AND NAME OF EMPLOYEE WORKING AS CLERK AND EARNING HIGHEST SALARY AMONG CLERKS.
SELECT EMPNO, ENAME FROM EMP WHERE JOB = 'CLERK' AND SAL = 
(SELECT MAX(SAL) FROM EMP WHERE JOB = 'CLERK');

-- 81. WRITE A QUERY TO FIND SMITH'S MANAGER'S MANAGER HIREDATE.
SELECT HIREDATE FROM EMP WHERE EMPNO = 
(SELECT MGR FROM EMP WHERE EMPNO = 
(SELECT MGR FROM EMP WHERE ENAME = 'SMITH'));

-- 82. LIST THE NUMBER OF EMPLOYEES WHOSE JOB IS SALESMAN WORKING FOR NEW YORK AND CHICAGO.
SELECT COUNT(*) FROM EMP WHERE JOB = 'SALESMAN' AND DEPTNO IN 
(SELECT DEPTNO FROM DEPT WHERE LOC IN ('NEW YORK', 'CHICAGO'));

-- 83. LIST THE DEPARTMENT NAMES IN WHICH THE EMPLOYEES ARE HIRED BETWEEN 1ST OF JAN 1981 AND 31ST DEC 1982 WITH SALARY MORE THAN 1800.
SELECT DNAME FROM DEPT WHERE DEPTNO IN 
(SELECT DISTINCT DEPTNO FROM EMP WHERE HIREDATE BETWEEN TO_DATE('01-JAN-1981', 'DD-MON-YYYY') 
AND TO_DATE('31-DEC-1982', 'DD-MON-YYYY') AND SAL > 1800);

-- 84. DISPLAY LOCATION OF THE EMPLOYEE WHO EARN MAXIMUM SALARY AND HAVE NO REPORTING MANAGER.
SELECT LOC FROM DEPT WHERE DEPTNO IN 
(SELECT DEPTNO FROM EMP WHERE SAL = (SELECT MAX(SAL) FROM EMP) AND MGR IS NULL);

-- 85. LIST EMPLOYEES WHO WORKS FOR ACCOUNTING DEPARTMENT AND THEIR SALARY GREATER THAN AVERAGE SALARY OF THEIR DEPARTMENT.
SELECT ENAME FROM EMP WHERE DEPTNO = 
(SELECT DEPTNO FROM DEPT WHERE DNAME = 'ACCOUNTING') 
AND SAL > (SELECT AVG(SAL) FROM EMP WHERE DEPTNO = 
(SELECT DEPTNO FROM DEPT WHERE DNAME = 'ACCOUNTING'));

-- 86. DISPLAY LOCATION OF THE EMPLOYEE WHO EARN COMMISSION.
SELECT LOC FROM DEPT WHERE DEPTNO IN 
(SELECT DISTINCT DEPTNO FROM EMP WHERE COMM IS NOT NULL);

-- 87. LIST THE EMPLOYEES WHO DOES NOT DIRECTLY REPORT TO PRESIDENT, HAVE COMMISSION AND SALARY MORE THAN MAX SALARY OF ALL THE CLERK WITHOUT USING NULL OR NOT NULL.
SELECT ENAME FROM EMP WHERE MGR <> (SELECT EMPNO FROM EMP WHERE JOB = 'PRESIDENT') 
AND COMM >= 0 AND SAL > (SELECT MAX(SAL) FROM EMP WHERE JOB = 'CLERK');

-- 88. DISPLAY ALL THE EMPLOYEES WHOSE SALARY IS GREATER THAN AVG SAL OF DEPARTMENT 20.
SELECT * FROM EMP WHERE SAL > 
(SELECT AVG(SAL) FROM EMP WHERE DEPTNO = 20);

-- 89. LIST THE EMPLOYEE DEPTNAME AND LOC OF ALL THE EMPLOYEES WHO ARE CLERK, REPORTING TO BLAKE AND SALARY IS LESSER THAN MARTIN SALARY.
SELECT DNAME, LOC FROM DEPT WHERE DEPTNO IN 
(SELECT DEPTNO FROM EMP WHERE JOB = 'CLERK' AND MGR = 
(SELECT EMPNO FROM EMP WHERE ENAME = 'BLAKE') 
AND SAL < (SELECT SAL FROM EMP WHERE ENAME = 'MARTIN'));

-- 90. DISPLAY LOC AND DNAME WHOSE JOB IS MANAGER AND HAS SAL LESS THAN CLERK.
SELECT LOC, DNAME FROM DEPT WHERE DEPTNO IN 
(SELECT DISTINCT DEPTNO FROM EMP WHERE JOB = 'MANAGER' AND SAL < 
(SELECT MIN(SAL) FROM EMP WHERE JOB = 'CLERK'));

-- 91. DISPLAY EMPLOYEES LOCATION WHO HAS SOME COMMISSION.
SELECT LOC FROM DEPT WHERE DEPTNO IN 
(SELECT DISTINCT DEPTNO FROM EMP WHERE COMM > 0);

-- 92. DISPLAY EMPNO, ENAME, JOB, WHOSE JOB HAS 'E' IN IT AND DISPLAY EMPNO IN DESCENDING ORDER.
SELECT EMPNO, ENAME, JOB FROM EMP WHERE JOB LIKE '%E%' ORDER BY EMPNO DESC;

-- 93. DISPLAY DNAME, LOC, DEPTNO OF EMPLOYEES WHO HAS SAME REPORTING MANAGER.
SELECT DNAME, LOC, DEPTNO FROM DEPT WHERE DEPTNO IN 
(SELECT DISTINCT DEPTNO FROM EMP WHERE MGR IN 
(SELECT DISTINCT MGR FROM EMP WHERE MGR IS NOT NULL));

-- 94. DISPLAY AVG SALARY OF ALL EMPLOYEES WHOSE DEPT NAME IS ACCOUNTING.
SELECT AVG(SAL) FROM EMP WHERE DEPTNO = 
(SELECT DEPTNO FROM DEPT WHERE DNAME = 'ACCOUNTING');

-- 95. DISPLAY ALL EMPLOYEES DETAILS WHOSE HIREDATE IS IN YEAR 81.
SELECT * FROM EMP WHERE TO_CHAR(HIREDATE, 'YY') = '81';

-- 96. DISPLAY DETAILS OF SMITH AND EMPLOYEES WORKING AS PRESIDENT ALONG WITH HIKE OF 35% SALARY.
SELECT EMP.*, (SAL * 1.35) AS HIKED_SAL FROM EMP WHERE ENAME = 'SMITH' 
OR JOB = 'PRESIDENT';

-- 97. DISPLAY NUMBER OF EMPLOYEES WHOSE COMMISSION IS MORE THAN SALARY.
SELECT COUNT(*) FROM EMP WHERE COMM > SAL;

-- 98. LIST THE EMPLOYEES WHOSE DAILY SALARY IS GREATER THAN 1500 AND WHO ARE JOINED BEFORE 1982 ONLY.
SELECT * FROM EMP WHERE (SAL/30) > 1500 AND TO_CHAR(HIREDATE, 'YYYY') < '1982';

-- 99. DISPLAY NUMBER OF EMPLOYEES WHOSE COMMISSION IS MORE THAN SALARY.
SELECT COUNT(*) FROM EMP WHERE COMM > SAL;

-- 100. LIST THE EMPLOYEES WHOSE DAILY SALARY IS GREATER THAN 1500 AND WHO ARE JOINED BEFORE 1982 ONLY.
SELECT * FROM EMP WHERE (SAL/30) > 1500 AND TO_CHAR(HIREDATE, 'YYYY') < '1982';

-- 101. DISPLAY ALL THE EMPLOYEES WHOSE JOB SAME AS 'SMITH' AND DEPARTMENT SAME AS 'JONES' AND SALARY MORE THAN 'TURNER'
SELECT * FROM EMP WHERE JOB = (SELECT JOB FROM EMP WHERE ENAME = 'SMITH') 
AND DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'JONES') 
AND SAL > (SELECT SAL FROM EMP WHERE ENAME = 'TURNER');

-- 102. DISPLAY ALL THE EMPLOYEES WHOSE NAME START WITH 'S' AND HAVING SALARY MORE THAN 'ALLEN' AND LESS THAN 'FORD'
SELECT * FROM EMP WHERE ENAME LIKE 'S%' 
AND SAL > (SELECT SAL FROM EMP WHERE ENAME = 'ALLEN') 
AND SAL < (SELECT SAL FROM EMP WHERE ENAME = 'FORD');

-- 103. DISPLAY ALL THE CLERKS AND ANALYST WHO ARE NOT WORKING FOR 'DALLAS'
SELECT * FROM EMP WHERE JOB IN ('CLERK', 'ANALYST') 
AND DEPTNO NOT IN (SELECT DEPTNO FROM DEPT WHERE LOC = 'DALLAS');

-- 104. DISPLAY DEPARTMENT NAME WHICH IS HAVING AT LEAST ONE 'MANAGER'
SELECT DNAME FROM DEPT WHERE DEPTNO IN 
(SELECT DISTINCT DEPTNO FROM EMP WHERE JOB = 'MANAGER');

-- 105. DISPLAY MAXIMUM SALARY OF 'SALES' DEPARTMENT
SELECT MAX(SAL) FROM EMP WHERE DEPTNO = 
(SELECT DEPTNO FROM DEPT WHERE DNAME = 'SALES');

-- 106. DISPLAY THE 2ND MAXIMUM SALARY
SELECT MAX(SAL) FROM EMP WHERE SAL < 
(SELECT MAX(SAL) FROM EMP);

-- 107. DISPLAY THE DEPT NAME OF THE EMP WHO GETS 3RD MAXIMUM SALARY
SELECT DNAME FROM DEPT WHERE DEPTNO = 
(SELECT DEPTNO FROM EMP WHERE SAL = 
(SELECT MAX(SAL) FROM EMP WHERE SAL < 
(SELECT MAX(SAL) FROM EMP WHERE SAL < 
(SELECT MAX(SAL) FROM EMP))));

-- 108. DISPLAY ALL THE EMPLOYEES WHO ARE EARNING MORE THAN ALL THE MANAGERS(JOB).
SELECT * FROM EMP WHERE SAL > 
(SELECT MAX(SAL) FROM EMP WHERE JOB = 'MANAGER');

-- 109. DISPLAY ALL THE EMPLOYEES WHO ARE EARNING MORE THAN ANY OF THE MANAGER(JOB)
SELECT * FROM EMP WHERE SAL > 
(SELECT MIN(SAL) FROM EMP WHERE JOB = 'MANAGER');

-- 110. SELECT EMPNO, JOB AND SALARY OF ALL THE ANALYST WHO ARE EARNING MORE THAN ANY OF THE MANAGER(JOB)
SELECT EMPNO, JOB, SAL FROM EMP WHERE JOB = 'ANALYST' 
AND SAL > (SELECT MIN(SAL) FROM EMP WHERE JOB = 'MANAGER');

-- 111. SELECT THE DEPARTMENT NAME AND LOCATION OF ALL THE EMPLOYEES WORKING FOR CLARK.
SELECT DNAME, LOC FROM DEPT WHERE DEPTNO = 
(SELECT DEPTNO FROM EMP WHERE ENAME = 'CLARK');

-- 112. SELECT ALL THE EMPLOYEES WORKING FOR DALLAS
SELECT * FROM EMP WHERE DEPTNO IN 
(SELECT DEPTNO FROM DEPT WHERE LOC = 'DALLAS');

-- 113. DISPLAY ALL THE EMPLOYEES WHOSE SALARY IS GREATER THAN AVG SAL OF DEPARTMENT 20
SELECT * FROM EMP WHERE SAL > 
(SELECT AVG(SAL) FROM EMP WHERE DEPTNO = 20);

-- 114. DISPLAY ALL THE EMPLOYEES WHO GETS MAXIMUM SALARY.
SELECT * FROM EMP WHERE SAL = (SELECT MAX(SAL) FROM EMP);

-- 115. DISPLAY FIRST EMPLOYEE RECORD BASED ON HIREDATE
SELECT * FROM EMP WHERE HIREDATE = 
(SELECT MIN(HIREDATE) FROM EMP);
